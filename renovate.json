{
  "extends": [
    "config:best-practices"
  ],
  "packageRules": [
    {
      "description": "Auto-merge minor and patch updates when CI passes",
      "matchUpdateTypes": ["minor", "patch", "digest"],
      "automerge": true
    }
  ],
  "argocd": {
    "managerFilePatterns": ["/\\.yaml$/"]
  },
  "customManagers": [
    {
      "customType": "regex",
      "description": "Update Helm chart versions in ArgoCD ApplicationSet list generators (HTTPS registries)",
      "managerFilePatterns": ["/^argocd\\/applications\\/.+\\/applicationset\\.yaml$/"],
      "matchStrings": [
        "- name: [^\\n]+\\n\\s+chart: (?<depName>[^\\s\\n]+)\\n\\s+chartVersion: (?<currentValue>[^\\s\\n]+)[\\s\\S]*?repoURL: (?<registryUrl>https?://[^\\s\\n]+)"
      ],
      "datasourceTemplate": "helm"
    },
    {
      "customType": "regex",
      "description": "Update TrueCharts OCI Helm chart versions in media ApplicationSets",
      "managerFilePatterns": ["/^argocd\\/applications\\/media\\/.+\\/applicationset\\.yaml$/"],
      "matchStrings": [
        "- name: [^\\n]+\\n\\s+chart: (?<depName>[^\\s\\n]+)\\n\\s+chartVersion: (?<currentValue>[^\\s\\n]+)"
      ],
      "datasourceTemplate": "docker",
      "packageNameTemplate": "truecharts/{{depName}}",
      "registryUrlTemplate": "https://oci.trueforge.org"
    }
  ]
}
