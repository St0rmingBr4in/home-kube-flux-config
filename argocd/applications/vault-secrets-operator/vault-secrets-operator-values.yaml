---
# Configure default Vault connection
defaultVaultConnection:
  enabled: true
  address: "https://vault.prod-infra.svc.cluster.local:8200"
  caCertSecret: "vault-internal-ca-secret"
  # Use internal service with custom CA certificate for TLS verification

# Configure default Kubernetes auth method
defaultAuthMethod:
  enabled: true
  namespace: "test" # Use test namespace instead of root
  allowedNamespaces: ["prod-infra", "prod-aphorya"] # Allow both infra and minecraft namespaces
  method: kubernetes
  mount: kubernetes
  kubernetes:
    role: vso # This role needs to be created in Vault
    serviceAccount: default # VSO will use the default service account
    tokenAudiences: []

# Controller configuration
controller:
  manager:
    # Resource configuration following our policy: memory request = limit, CPU request only
    resources:
      requests:
        memory: 128Mi # Conservative for VSO controller
        cpu: 100m # Based on typical VSO usage
      limits:
        memory: 128Mi # Same as request for guaranteed QoS (Gatekeeper compliance)
        # No CPU limit to allow bursting
    # Enable client cache for better performance
    clientCache:
      persistenceModel: "none" # In-memory only for simplicity
      cacheSize: 1000
    # Global options
    globalTransformationOptions:
      excludeRaw: false # Include raw secret data

# Metrics and monitoring
metricsService:
  enabled: true

# Enable ServiceMonitor for Prometheus (if needed)
telemetry:
  serviceMonitor:
    enabled: false # Can be enabled later if Prometheus is available
