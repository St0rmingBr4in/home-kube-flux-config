---
# Vault Secrets Operator configuration

defaultVaultConnection:
  enabled: true
  # Use HTTPS with proper TLS configuration
  address: "https://vault.prod-infra.svc.cluster.local:8200"
  caCertSecretRef: "vault-internal-ca-secret"
  skipTLSVerify: false

defaultAuthMethod:
  enabled: true
  namespace: "prod-infra" # Use prod-infra namespace where VSO is deployed
  allowedNamespaces: ["prod-infra", "prod-aphorya"] # Allow both infra and minecraft namespaces
  method: kubernetes
  mount: kubernetes
  kubernetes:
    role: vso
    serviceAccount: default
    tokenExpirationSeconds: 600

# Controller configuration
controller:
  manager:
    # Resource configuration following our policy: memory request = limit, CPU request only
    resources:
      requests:
        memory: 128Mi # Conservative for VSO controller
        cpu: 100m # Based on typical VSO usage
      limits:
        memory: 128Mi # Same as request for guaranteed QoS (Gatekeeper compliance)
        # No CPU limit to allow bursting
    # Enable client cache for better performance
    clientCache:
      persistenceModel: "none" # In-memory only for simplicity
      cacheSize: 1000
    # Global options
    globalTransformationOptions:
      excludeRaw: false # Include raw secret data

# Metrics and monitoring
metricsService:
  enabled: true

# Enable ServiceMonitor for Prometheus (if needed)
telemetry:
  serviceMonitor:
    enabled: false # Can be enabled later if Prometheus is available
