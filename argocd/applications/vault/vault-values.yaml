---
global:
  enabled: true
  tlsDisable: false

server:
  resources:
    requests:
      memory: 150Mi
      cpu: 100m
    limits:
      memory: 150Mi

  # Environment variables for TLS
  extraEnvironmentVars:
    VAULT_CACERT: /vault/userconfig/vault-internal-tls-cert/ca.crt
    VAULT_TLSCERT: /vault/userconfig/vault-internal-tls-cert/tls.crt
    VAULT_TLSKEY: /vault/userconfig/vault-internal-tls-cert/tls.key

  # Mount TLS certificates
  volumes:
    - name: vault-internal-tls-cert
      secret:
        secretName: vault-internal-tls-cert

  volumeMounts:
    - mountPath: /vault/userconfig/vault-internal-tls-cert
      name: vault-internal-tls-cert
      readOnly: true

  # Standalone mode with TLS
  standalone:
    enabled: true
    config: |
      ui = true
      listener "tcp" {
        tls_disable = 0
        address = "[::]:8200"
        cluster_address = "[::]:8201"
        tls_cert_file = "/vault/userconfig/vault-internal-tls-cert/tls.crt"
        tls_key_file = "/vault/userconfig/vault-internal-tls-cert/tls.key"
        tls_client_ca_file = "/vault/userconfig/vault-internal-tls-cert/ca.crt"
      }
      storage "file" {
        path = "/vault/data"
      }
      disable_mlock = true
      service_registration "kubernetes" {}

  # External ingress (optional)
  ingress:
    enabled: true
    hosts:
      - host: vault.st0rmingbr4in.com
        paths: ["/"]
    tls:
      - secretName: st0rmingbr4in.com-cert
        hosts:
          - vault.st0rmingbr4in.com
    annotations:
      # Backend HTTPS configuration with TLS verification
      traefik.ingress.kubernetes.io/service.serversscheme: https
      traefik.ingress.kubernetes.io/service.serverstransport: vault-backend-transport@containo

ui:
  enabled: true

injector:
  enabled: false
